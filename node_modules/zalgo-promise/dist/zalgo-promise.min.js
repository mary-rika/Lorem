!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("ZalgoPromise",[],r):"object"==typeof exports?exports.ZalgoPromise=r():e.ZalgoPromise=r()}("undefined"!=typeof self?self:this,function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";function n(e){try{if(!e)return!1;if("undefined"!=typeof Promise&&e instanceof Promise)return!0;if("undefined"!=typeof window&&window.Window&&e instanceof window.Window)return!1;if("undefined"!=typeof window&&window.constructor&&e instanceof window.constructor)return!1;var r={}.toString;if(r){var t=r.call(e);if("[object Window]"===t||"[object global]"===t||"[object DOMWindow]"===t)return!1}if("function"==typeof e.then)return!0}catch(e){return!1}return!1}function o(){var e=void 0;if("undefined"!=typeof window)e=window;else{if("undefined"==typeof window)throw new TypeError("Can not find global");e=window}var r=e.__zalgopromise__=e.__zalgopromise__||{};return r.flushPromises=r.flushPromises||[],r.activeCount=r.activeCount||0,r.possiblyUnhandledPromiseHandlers=r.possiblyUnhandledPromiseHandlers||[],r.dispatchedErrors=r.dispatchedErrors||[],r}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(r){var t=this;if(function(r,t){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],r){var n=void 0,o=void 0,i=!1,s=!1,u=!1;try{r(function(e){u?t.resolve(e):(i=!0,n=e)},function(e){u?t.reject(e):(s=!0,o=e)})}catch(e){return void this.reject(e)}u=!0,i?this.resolve(n):s&&this.reject(o)}}return e.prototype.resolve=function(e){if(this.resolved||this.rejected)return this;if(n(e))throw new Error("Can not resolve promise with another promise");return this.resolved=!0,this.value=e,this.dispatch(),this},e.prototype.reject=function(e){var r=this;if(this.resolved||this.rejected)return this;if(n(e))throw new Error("Can not reject promise with another promise");if(!e){var t=e&&"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e);e=new Error("Expected reject to be called with Error, got "+t)}return this.rejected=!0,this.error=e,this.errorHandled||setTimeout(function(){r.errorHandled||function(e,r){if(-1===o().dispatchedErrors.indexOf(e)){o().dispatchedErrors.push(e),setTimeout(function(){throw e},1);for(var t=0;t<o().possiblyUnhandledPromiseHandlers.length;t++)o().possiblyUnhandledPromiseHandlers[t](e,r)}}(e,r)},1),this.dispatch(),this},e.prototype.asyncReject=function(e){this.errorHandled=!0,this.reject(e)},e.prototype.dispatch=function(){var r=this,t=this.dispatching,i=this.resolved,s=this.rejected,u=this.handlers;if(!t&&(i||s)){this.dispatching=!0,o().activeCount+=1;for(var c=function(t){var o=u[t],c=o.onSuccess,f=o.onError,l=o.promise,a=void 0;if(i)try{a=c?c(r.value):r.value}catch(e){return l.reject(e),"continue"}else if(s){if(!f)return l.reject(r.error),"continue";try{a=f(r.error)}catch(e){return l.reject(e),"continue"}}a instanceof e&&(a.resolved||a.rejected)?(a.resolved?l.resolve(a.value):l.reject(a.error),a.errorHandled=!0):n(a)?a instanceof e&&(a.resolved||a.rejected)?a.resolved?l.resolve(a.value):l.reject(a.error):a.then(function(e){l.resolve(e)},function(e){l.reject(e)}):l.resolve(a)},f=0;f<u.length;f++)c(f);u.length=0,this.dispatching=!1,o().activeCount-=1,0===o().activeCount&&e.flushQueue()}},e.prototype.then=function(r,t){if(r&&"function"!=typeof r&&!r.call)throw new Error("Promise.then expected a function for success handler");if(t&&"function"!=typeof t&&!t.call)throw new Error("Promise.then expected a function for error handler");var n=new e;return this.handlers.push({promise:n,onSuccess:r,onError:t}),this.errorHandled=!0,this.dispatch(),n},e.prototype.catch=function(e){return this.then(void 0,e)},e.prototype.finally=function(r){if(r&&"function"!=typeof r&&!r.call)throw new Error("Promise.finally expected a function");return this.then(function(t){return e.try(r).then(function(){return t})},function(t){return e.try(r).then(function(){throw t})})},e.prototype.timeout=function(e,r){var t=this;if(this.resolved||this.rejected)return this;var n=setTimeout(function(){t.resolved||t.rejected||t.reject(r||new Error("Promise timed out after "+e+"ms"))},e);return this.then(function(e){return clearTimeout(n),e})},e.prototype.toPromise=function(){if("undefined"==typeof Promise)throw new TypeError("Could not find Promise");return Promise.resolve(this)},e.resolve=function(r){return r instanceof e?r:n(r)?new e(function(e,t){return r.then(e,t)}):(new e).resolve(r)},e.reject=function(r){return(new e).reject(r)},e.all=function(r){var t=new e,o=r.length,i=[];if(!o)return t.resolve(i),t;for(var s=function(s){var u=r[s];if(u instanceof e){if(u.resolved)return i[s]=u.value,o-=1,"continue"}else if(!n(u))return i[s]=u,o-=1,"continue";e.resolve(u).then(function(e){i[s]=e,0==(o-=1)&&t.resolve(i)},function(e){t.reject(e)})},u=0;u<r.length;u++)s(u);return 0===o&&t.resolve(i),t},e.hash=function(r){var t={};return e.all(Object.keys(r).map(function(n){return e.resolve(r[n]).then(function(e){t[n]=e})})).then(function(){return t})},e.map=function(r,t){return e.all(r.map(t))},e.onPossiblyUnhandledException=function(e){return function(e){return o().possiblyUnhandledPromiseHandlers.push(e),{cancel:function(){o().possiblyUnhandledPromiseHandlers.splice(o().possiblyUnhandledPromiseHandlers.indexOf(e),1)}}}(e)},e.try=function(r,t,n){if(r&&"function"!=typeof r&&!r.call)throw new Error("Promise.try expected a function");var o=void 0;try{o=r.apply(t,n||[])}catch(r){return e.reject(r)}return e.resolve(o)},e.delay=function(r){return new e(function(e){setTimeout(e,r)})},e.isPromise=function(r){return!!(r&&r instanceof e)||n(r)},e.flush=function(){var r=new e;return o().flushPromises.push(r),0===o().activeCount&&e.flushQueue(),r},e.flushQueue=function(){var e=o().flushPromises;o().flushPromises=[];for(var r=0,t=null==e?0:e.length;r<t;r++)e[r].resolve()},e}();t.d(r,"ZalgoPromise",function(){return i})}])});
//# sourceMappingURL=zalgo-promise.min.js.map
//# sourceMappingURL=zalgo-promise.min.js.map